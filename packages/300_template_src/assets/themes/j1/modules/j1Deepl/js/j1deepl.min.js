/*
 # -----------------------------------------------------------------------------
 # ~/assets/themes/j1/modules/j1Deepl/js/j1deepl.min.js
 # J1 core module for j1Deepl
 #
 # Product/Info:
 # https://jekyll.one
 #
 # Copyright (C) 2021 Juergen Adams
 #
 # J1 Template is licensed under the MIT License.
 # For details, see https://jekyll.one
 # -----------------------------------------------------------------------------
 # NOTE: Based on https://github.com/jquery-boilerplate/jquery-boilerplate
 # See:  https://www.dotnetcurry.com/jquery/1069/authoring-jquery-plugins
 # -----------------------------------------------------------------------------
*/
(function(e,c,a,g){var d="j1deepl",f={api:"free",source_lang:"auto",target_lang:"DE",split_sentences:false,preserve_formatting:true,formality:"default",tag_handling:"none",non_splitting_tags:"none",outline_detection:false,splitting_tags:"none",ignore_tags:"none",onInit:function(){},onBeforeTranslation:function(){},onAfterTranslation:function(){}};function b(i,h){this.element=i;this.settings=e.extend({},f,h);this.settings.elementID="#"+this.element.id;this.xhr=new XMLHttpRequest();this.init(this.settings)}e.extend(b.prototype,{init:function(i){var h=log4javascript.getLogger("j1deepl.init");h.info("\ninitializing plugin: started");this.translate(i);h.info("\ninitializing plugin: finished")},prepareXHR:function(h){if(h.api==="free"){this.xhr.open("POST","https://api-free.deepl.com/v2/translate",true)}else{if(h.api==="pro"){this.xhr.open("POST","https://api.deepl.com/v2/translate",true)}else{this.xhr.open("POST","https://api-free.deepl.com/v2/translate",true)}}this.xhr.setRequestHeader("Accept","*/*");this.xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded")},prepareText:function(h){return h.split("\n")},translate:function(j){var t=log4javascript.getLogger("j1deepl.translate");var h=4;var q=200;var r=j.targetElement;var k=(r.includes(".")||r.includes("#"))?r.substring(1):r;var n=e(r).get(0).nodeName;if(n==="TEXTAREA"){var s=this.element.value;var p=this.prepareText(s)}else{if(n==="P"){var m=this.element;var s=e(r).text();var p=this.prepareText(s)}}this.prepareXHR(j);var o="";for(var l=0;l<p.length;l++){o+="&text="+p[l]}this.xhr.onload=function(){if(this.readyState===h){if(this.status===q){var u=JSON.parse(this.responseText);var v="";for(var w=0;w<u.translations.length;w++){v+=u.translations[w].text;v+="\n"}if(n==="TEXTAREA"){e(r).val(v)}else{if(n==="P"){e(r).text(v)}}}}};if(this.settings.source_lang==!"auto"){this.xhr.send("auth_key="+this.settings.auth_key+o+"&source_lang="+this.settings.source_lang+"&target_lang="+this.settings.target_lang)}else{this.xhr.send("auth_key="+this.settings.auth_key+o+"&target_lang="+this.settings.target_lang)}}});e.fn[d]=function(i){var h=arguments;if(i===g||typeof i==="object"){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,i))}})}else{if(typeof i==="string"&&i[0]!=="_"&&i!=="init"){var j;this.each(function(){var k=e.data(this,"plugin_"+d);if(k instanceof b&&typeof k[i]==="function"){j=k[i].apply(k,Array.prototype.slice.call(h,1))}if(i==="destroy"){e.data(this,"plugin_"+d,null)}});return j!==g?j:this}}}})(jQuery,window,document);
